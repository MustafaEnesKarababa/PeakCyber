{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///app/src/api/scans.ts"],"sourcesContent":["const API_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || 'https://localhost:7095/api';\r\nimport {getToken} from './token'\r\n\r\ntype StartScanApiResponse = {\r\n  RunId?: string; runId?: string;\r\n  ScanId?: number; scanId?: number;\r\n};\r\n\r\nexport async function startScan(targetUrl: string, runId: string) {\r\n  const token = getToken()\r\n\r\n  if (!token) \r\n    {\r\n      throw new Error(\"Unauthorized\")\r\n    }\r\n\r\n  const res = await fetch(`${API_BASE}/Vulnerability/start-scan`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n   \r\n    body: JSON.stringify({ TargetUrl: targetUrl, OperationId: runId }),\r\n  });\r\n\r\n  if (!res.ok) \r\n    throw new Error((await res.text()) || \"Failed to start scan\")\r\n\r\n  const data: StartScanApiResponse = await res.json()\r\n\r\n  const RunId = data.RunId ?? data.runId ?? runId\r\n\r\n  const ScanId = data.ScanId ?? data.scanId ?? null\r\n\r\n  return { RunId, ScanId }\r\n}\r\n\r\n\r\n\r\nexport async function getScan (id : number){\r\n  const token = getToken();\r\n  if(!token){\r\n    throw new Error('Unauthorized');\r\n  }\r\n\r\n  const response = await fetch(`${API_BASE}/Vulnerability/get-scan/${id}`, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`,\r\n      'Content-Type': 'application/json'\r\n    }\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error(await response.text() || 'Failed to get scan');\r\n  }\r\n\r\n  return response.json();\r\n\r\n}\r\n\r\nexport async function getScans() {\r\n  const token = getToken();\r\n  if(!token){\r\n    throw new Error('Unauthorized');\r\n  }\r\n\r\n  const response = await fetch(`${API_BASE}/Vulnerability/get-scans`, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`,\r\n      'Content-Type': 'application/json'\r\n    }\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error(await response.text() || 'Failed to get scans');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\nexport async function getAllScans(){\r\n  const token = getToken();\r\n  if(!token){\r\n    throw new Error('Unauthorized');\r\n  }\r\n\r\n  const response = await fetch(`${API_BASE}/Admin/get-all-scans`, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Authorization': `Bearer ${token}`,\r\n      'Content-Type': 'application/json',\r\n      \r\n    }\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error(await response.text() || 'Failed to get all scans');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n\r\n  \r\n"],"names":[],"mappings":";;;;;;AAAiB;AACjB;AADA,MAAM,WAAW,iEAAwC;;AAQlD,eAAe,UAAU,SAAiB,EAAE,KAAa;IAC9D,MAAM,QAAQ,CAAA,GAAA,sHAAA,CAAA,WAAQ,AAAD;IAErB,IAAI,CAAC,OACH;QACE,MAAM,IAAI,MAAM;IAClB;IAEF,MAAM,MAAM,MAAM,MAAM,AAAC,GAAW,OAAT,UAAS,8BAA4B;QAC9D,QAAQ;QACR,SAAS;YACP,eAAe,AAAC,UAAe,OAAN;YACzB,gBAAgB;QAClB;QAEA,MAAM,KAAK,SAAS,CAAC;YAAE,WAAW;YAAW,aAAa;QAAM;IAClE;IAEA,IAAI,CAAC,IAAI,EAAE,EACT,MAAM,IAAI,MAAM,AAAC,MAAM,IAAI,IAAI,MAAO;IAExC,MAAM,OAA6B,MAAM,IAAI,IAAI;QAEnC,aAAA;IAAd,MAAM,QAAQ,CAAA,OAAA,CAAA,cAAA,KAAK,KAAK,cAAV,yBAAA,cAAc,KAAK,KAAK,cAAxB,kBAAA,OAA4B;QAE3B,cAAA;IAAf,MAAM,SAAS,CAAA,QAAA,CAAA,eAAA,KAAK,MAAM,cAAX,0BAAA,eAAe,KAAK,MAAM,cAA1B,mBAAA,QAA8B;IAE7C,OAAO;QAAE;QAAO;IAAO;AACzB;AAIO,eAAe,QAAS,EAAW;IACxC,MAAM,QAAQ,CAAA,GAAA,sHAAA,CAAA,WAAQ,AAAD;IACrB,IAAG,CAAC,OAAM;QACR,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,WAAW,MAAM,MAAM,AAAC,GAAqC,OAAnC,UAAS,4BAA6B,OAAH,KAAM;QACvE,QAAQ;QACR,SAAS;YACP,iBAAiB,AAAC,UAAe,OAAN;YAC3B,gBAAgB;QAClB;IACF;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,MAAM,SAAS,IAAI,MAAM;IAC3C;IAEA,OAAO,SAAS,IAAI;AAEtB;AAEO,eAAe;IACpB,MAAM,QAAQ,CAAA,GAAA,sHAAA,CAAA,WAAQ,AAAD;IACrB,IAAG,CAAC,OAAM;QACR,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,WAAW,MAAM,MAAM,AAAC,GAAW,OAAT,UAAS,6BAA2B;QAClE,QAAQ;QACR,SAAS;YACP,iBAAiB,AAAC,UAAe,OAAN;YAC3B,gBAAgB;QAClB;IACF;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,MAAM,SAAS,IAAI,MAAM;IAC3C;IAEA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe;IACpB,MAAM,QAAQ,CAAA,GAAA,sHAAA,CAAA,WAAQ,AAAD;IACrB,IAAG,CAAC,OAAM;QACR,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,WAAW,MAAM,MAAM,AAAC,GAAW,OAAT,UAAS,yBAAuB;QAC9D,QAAQ;QACR,SAAS;YACP,iBAAiB,AAAC,UAAe,OAAN;YAC3B,gBAAgB;QAElB;IACF;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,MAAM,SAAS,IAAI,MAAM;IAC3C;IAEA,OAAO,SAAS,IAAI;AACtB","debugId":null}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/dashboard/my-scans/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { getScans } from \"@/api/scans\";\r\n\r\nexport default function ScanHistoryPage() {\r\n  const [scans, setScans] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [selectedScanId, setSelectedScanId] = useState<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      try {\r\n        const list = await getScans();\r\n        setScans(Array.isArray(list) ? list : []);\r\n      } catch (e: any) {\r\n        setError(e.message || \"Failed to load scans\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <main className=\"min-h-screen grid place-items-center p-6\">\r\n        <p>Loading...</p>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <main className=\"p-6 min-w-0\">\r\n      <h1 className=\"text-2xl font-semibold mb-4\">Scan History</h1>\r\n\r\n      {error && <p className=\"text-red-600 mb-3\">{error}</p>}\r\n\r\n      {scans.length === 0 ? (\r\n        <p className=\"opacity-80\">No scans found</p>\r\n      ) : (\r\n        <div className=\"space-y-3\">\r\n          {scans.map((scan) => {\r\n            return (\r\n              <div key={scan.id} className=\"border rounded p-3 max-w-full\">\r\n                <div className=\"flex item-start justify-between gap-4\">\r\n                  <div className=\"text-sm min-w-0\">\r\n                    <div>\r\n                      <span className=\"opacity-70\">Scan ID :</span>\r\n                      <span className=\"font-font-mono\">{scan.id}</span>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"opacity-70\">Target URL :</span>\r\n                      <span className=\"break-all [overflow-wrap:anywhere]\">\r\n                        {scan.targetUrl}\r\n                      </span>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"opacity-70\">Scan Date :</span>\r\n                      <span className=\"font-font-mono\">\r\n                        {new Date(scan.scanDate).toLocaleString()}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <button\r\n                    className=\"border rounded px-3 py-1 text-sm shrink-0\"\r\n                    onClick={() =>\r\n                      setSelectedScanId(selectedScanId ? null : Number(scan.id))\r\n                    }\r\n                    disabled={!scan.scanresult}\r\n                  >\r\n                    {selectedScanId === scan.id ? \"Hide Result\" : \"Show Result\"}\r\n                  </button>\r\n                </div>\r\n\r\n                {selectedScanId === scan.id && scan.scanresult && (\r\n                  <div className=\"mt-3\">\r\n                    <div className=\"font-medium mb-1\">Scan Result:</div>\r\n                    <pre\r\n                      className=\"\r\n                        text-xs  text-gray-100 rounded p-3\r\n                        whitespace-pre-wrap break-words [overflow-wrap:anywhere]\r\n                        max-w-full max-h-96 overflow-auto\"\r\n                    >\r\n                      {JSON.stringify(JSON.parse(scan.scanresult ?? scan.scanresult), null, 2)}\r\n                    </pre>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;;;AAHA;;;AAKe,SAAS;;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAS,EAAE;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAClD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB;IAEpE,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;qCAAE;YACR;6CAAC;oBACC,IAAI;wBACF,MAAM,OAAO,MAAM,CAAA,GAAA,sHAAA,CAAA,WAAQ,AAAD;wBAC1B,SAAS,MAAM,OAAO,CAAC,QAAQ,OAAO,EAAE;oBAC1C,EAAE,OAAO,GAAQ;wBACf,SAAS,EAAE,OAAO,IAAI;oBACxB,SAAU;wBACR,WAAW;oBACb;gBACF;aAAC;QACH;oCAAG,EAAE;IAEL,IAAI,SAAS;QACX,qBACE,6LAAC;YAAK,WAAU;sBACd,cAAA,6LAAC;0BAAE;;;;;;;;;;;IAGT;IAEA,qBACE,6LAAC;QAAK,WAAU;;0BACd,6LAAC;gBAAG,WAAU;0BAA8B;;;;;;YAE3C,uBAAS,6LAAC;gBAAE,WAAU;0BAAqB;;;;;;YAE3C,MAAM,MAAM,KAAK,kBAChB,6LAAC;gBAAE,WAAU;0BAAa;;;;;qCAE1B,6LAAC;gBAAI,WAAU;0BACZ,MAAM,GAAG,CAAC,CAAC;wBA2C2B;oBA1CrC,qBACE,6LAAC;wBAAkB,WAAU;;0CAC3B,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;;kEACC,6LAAC;wDAAK,WAAU;kEAAa;;;;;;kEAC7B,6LAAC;wDAAK,WAAU;kEAAkB,KAAK,EAAE;;;;;;;;;;;;0DAE3C,6LAAC;;kEACC,6LAAC;wDAAK,WAAU;kEAAa;;;;;;kEAC7B,6LAAC;wDAAK,WAAU;kEACb,KAAK,SAAS;;;;;;;;;;;;0DAGnB,6LAAC;;kEACC,6LAAC;wDAAK,WAAU;kEAAa;;;;;;kEAC7B,6LAAC;wDAAK,WAAU;kEACb,IAAI,KAAK,KAAK,QAAQ,EAAE,cAAc;;;;;;;;;;;;;;;;;;kDAK7C,6LAAC;wCACC,WAAU;wCACV,SAAS,IACP,kBAAkB,iBAAiB,OAAO,OAAO,KAAK,EAAE;wCAE1D,UAAU,CAAC,KAAK,UAAU;kDAEzB,mBAAmB,KAAK,EAAE,GAAG,gBAAgB;;;;;;;;;;;;4BAIjD,mBAAmB,KAAK,EAAE,IAAI,KAAK,UAAU,kBAC5C,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;kDAAmB;;;;;;kDAClC,6LAAC;wCACC,WAAU;kDAKT,KAAK,SAAS,CAAC,KAAK,KAAK,CAAC,CAAA,mBAAA,KAAK,UAAU,cAAf,8BAAA,mBAAmB,KAAK,UAAU,GAAG,MAAM;;;;;;;;;;;;;uBAzCpE,KAAK,EAAE;;;;;gBA+CrB;;;;;;;;;;;;AAKV;GA3FwB;KAAA","debugId":null}}]
}