{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 13, "column": 0}, "map": {"version":3,"sources":["file:///app/src/components/dashboard/Navbar.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect, useRef, use } from \"react\";\r\n\r\ntype Props = {\r\n  username: string;\r\n  role: string;\r\n  onLogout: () => void;\r\n};\r\n\r\nexport default function Navbar({ username, role, onLogout }: Props) {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const boxRef = useRef<HTMLDivElement>(null);\r\n\r\n  useEffect(() => {\r\n    const onDocumentClick = (e: MouseEvent) => {\r\n      if (boxRef.current && !boxRef.current.contains(e.target as Node)) {\r\n        setIsOpen(false);\r\n      }\r\n    };\r\n    document.addEventListener(\"click\", onDocumentClick);\r\n    return () => document.removeEventListener(\"click\", onDocumentClick);\r\n  }, []);\r\n\r\n  return (\r\n    <header className=\"h-14 border-b flex items-center justify-between px-4\">\r\n      <div className=\"font-semibold tracking-wide\">Vulnerability Scan</div>\r\n      <div className=\"flex items-center gap-4 relative\" ref={boxRef}>\r\n        <div className=\"text-sm text-right leading-tight\">\r\n          <div className=\"font-medium\">{username}</div>\r\n          <div className=\"opacity-70\">{role}</div>\r\n        </div>\r\n        <button\r\n          onClick={() => setIsOpen((v) => !v)}\r\n          className=\"border rounded px-3 py-1 text-sm hover:bg-gray-50 hover:text-black\"\r\n          aria-expanded={isOpen}\r\n          aria-haspopup=\"menu\"\r\n        >\r\n          Account\r\n        </button>\r\n      </div>\r\n\r\n      {isOpen && (\r\n        <div\r\n          className=\"absolute right-0 top-10 w-44 border rounded bg-gray-50 text-black shadow-md overflow-hidden\"\r\n          role=\"menu\"\r\n        >\r\n          <a\r\n            className=\"block px-3 py-2 hover:bg-gray-100 text-sm\"\r\n            href=\"/account\"\r\n          >\r\n            Account Settings\r\n          </a>\r\n          <button\r\n            className=\"block w-full text-left px-3 py-2 hover:bg-gray-100 text-sm\"\r\n            onClick={onLogout}\r\n          >\r\n            Logout\r\n          </button>\r\n        </div>\r\n      )}\r\n    </header>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AAFA;;;AAUe,SAAS,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,QAAQ,EAAS;IAChE,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACrC,MAAM,SAAS,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAkB;IAEtC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,kBAAkB,CAAC;YACvB,IAAI,OAAO,OAAO,IAAI,CAAC,OAAO,OAAO,CAAC,QAAQ,CAAC,EAAE,MAAM,GAAW;gBAChE,UAAU;YACZ;QACF;QACA,SAAS,gBAAgB,CAAC,SAAS;QACnC,OAAO,IAAM,SAAS,mBAAmB,CAAC,SAAS;IACrD,GAAG,EAAE;IAEL,qBACE,8OAAC;QAAO,WAAU;;0BAChB,8OAAC;gBAAI,WAAU;0BAA8B;;;;;;0BAC7C,8OAAC;gBAAI,WAAU;gBAAmC,KAAK;;kCACrD,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAU;0CAAe;;;;;;0CAC9B,8OAAC;gCAAI,WAAU;0CAAc;;;;;;;;;;;;kCAE/B,8OAAC;wBACC,SAAS,IAAM,UAAU,CAAC,IAAM,CAAC;wBACjC,WAAU;wBACV,iBAAe;wBACf,iBAAc;kCACf;;;;;;;;;;;;YAKF,wBACC,8OAAC;gBACC,WAAU;gBACV,MAAK;;kCAEL,8OAAC;wBACC,WAAU;wBACV,MAAK;kCACN;;;;;;kCAGD,8OAAC;wBACC,WAAU;wBACV,SAAS;kCACV;;;;;;;;;;;;;;;;;;AAOX","debugId":null}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///app/src/components/dashboard/Sidebar.tsx"],"sourcesContent":["'use Client'\r\nimport Link from 'next/link'\r\nimport { usePathname } from 'next/navigation';\r\n\r\nexport default function SideBar({role} : {role: string}) {\r\n\r\n  const pathname = usePathname()\r\n\r\n  const links = [\r\n    { href: '/dashboard/start-scan', label: 'Start Scan' },\r\n    \r\n    { href: '/dashboard/my-scans', label: 'Scan History' }\r\n\r\n  ]\r\n\r\n  const adminLinks = []\r\n\r\n  if(role === 'Admin') {\r\n    adminLinks.push(\r\n      { href: '/dashboard/get-all-scans', label: 'All Scans' },\r\n      { href: '/dashboard/manage-users', label: 'Manage Users' },\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <aside className='w-60 border-r p-3 space-y-1'>\r\n      {links.map((link) => (\r\n        <Link\r\n          key={link.href}\r\n          href={link.href}\r\n          className={`block px-3 py-2 rounded text-sm\r\n             ${pathname === link.href ? 'bg-gray-200 font-medium text-black' : 'hover:bg-gray-50 hover:text-black  '}`}\r\n        >\r\n          {link.label}\r\n        </Link>\r\n      ))}\r\n      {adminLinks.length > 0 && (\r\n        <>\r\n          \r\n          <hr className=\"my-2\" />\r\n          {adminLinks.map((link) => (\r\n            <Link\r\n              key={link.href}\r\n              href={link.href}\r\n              className={`block px-3 py-2 rounded text-sm\r\n             ${pathname === link.href ? 'bg-gray-200 font-medium text-black' : 'hover:bg-gray-50 hover:text-black  '}`}\r\n        >\r\n          {link.label}\r\n        </Link>\r\n      ))}\r\n        </>\r\n      )}\r\n    </aside>\r\n  )\r\n\r\n\r\n\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AAFA;;;;AAIe,SAAS,QAAQ,EAAC,IAAI,EAAkB;IAErD,MAAM,WAAW,CAAA,GAAA,kIAAA,CAAA,cAAW,AAAD;IAE3B,MAAM,QAAQ;QACZ;YAAE,MAAM;YAAyB,OAAO;QAAa;QAErD;YAAE,MAAM;YAAuB,OAAO;QAAe;KAEtD;IAED,MAAM,aAAa,EAAE;IAErB,IAAG,SAAS,SAAS;QACnB,WAAW,IAAI,CACb;YAAE,MAAM;YAA4B,OAAO;QAAY,GACvD;YAAE,MAAM;YAA2B,OAAO;QAAe;IAE7D;IAEA,qBACE,8OAAC;QAAM,WAAU;;YACd,MAAM,GAAG,CAAC,CAAC,qBACV,8OAAC,4JAAA,CAAA,UAAI;oBAEH,MAAM,KAAK,IAAI;oBACf,WAAW,CAAC;aACT,EAAE,aAAa,KAAK,IAAI,GAAG,uCAAuC,uCAAuC;8BAE3G,KAAK,KAAK;mBALN,KAAK,IAAI;;;;;YAQjB,WAAW,MAAM,GAAG,mBACnB;;kCAEE,8OAAC;wBAAG,WAAU;;;;;;oBACb,WAAW,GAAG,CAAC,CAAC,qBACf,8OAAC,4JAAA,CAAA,UAAI;4BAEH,MAAM,KAAK,IAAI;4BACf,WAAW,CAAC;aACb,EAAE,aAAa,KAAK,IAAI,GAAG,uCAAuC,uCAAuC;sCAE3G,KAAK,KAAK;2BALF,KAAK,IAAI;;;;;;;;;;;;;AAe5B","debugId":null}},
    {"offset": {"line": 230, "column": 0}, "map": {"version":3,"sources":["file:///app/src/api/token.ts"],"sourcesContent":["const KEY = 'auth_token';\r\n\r\nexport const saveToken = (token: string) => {\r\n  localStorage.setItem(KEY, token);\r\n}\r\n\r\nexport const getToken  = () => {\r\n  return localStorage.getItem(KEY);\r\n}\r\n\r\nexport const removeToken = () => {\r\n  localStorage.removeItem(KEY);\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA,MAAM,MAAM;AAEL,MAAM,YAAY,CAAC;IACxB,aAAa,OAAO,CAAC,KAAK;AAC5B;AAEO,MAAM,WAAY;IACvB,OAAO,aAAa,OAAO,CAAC;AAC9B;AAEO,MAAM,cAAc;IACzB,aAAa,UAAU,CAAC;AAC1B","debugId":null}},
    {"offset": {"line": 249, "column": 0}, "map": {"version":3,"sources":["file:///app/src/api/profile.ts"],"sourcesContent":["const API_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || 'https://localhost:7095/api';\r\n\r\nimport {getToken} from '@/api/token';\r\n\r\nexport type Profile = {\r\n  id : number;\r\n  username: string;\r\n  email: string;\r\n  createdAt: string;\r\n  role: string;\r\n}\r\n\r\nexport async function getProfile() : Promise<Profile>{\r\n  const token = getToken();\r\n  if(!token){\r\n    throw new Error('No authentication token found');\r\n  }\r\n\r\n  const response = await fetch(`${API_BASE}/User/profile`, {\r\n    method: 'GET',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'Authorization': `Bearer ${token}`,\r\n    },\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch user profile');\r\n  }\r\n\r\n  const data = await response.json();\r\n  return data;\r\n}"],"names":[],"mappings":";;;AAEA;AAFA,MAAM,WAAW,iEAAwC;;AAYlD,eAAe;IACpB,MAAM,QAAQ,CAAA,GAAA,mHAAA,CAAA,WAAQ,AAAD;IACrB,IAAG,CAAC,OAAM;QACR,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,aAAa,CAAC,EAAE;QACvD,QAAQ;QACR,SAAS;YACP,gBAAgB;YAChB,iBAAiB,CAAC,OAAO,EAAE,OAAO;QACpC;IACF;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,OAAO;AACT","debugId":null}},
    {"offset": {"line": 277, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/dashboard/layout.tsx"],"sourcesContent":["'use client';\r\nimport { useState, useEffect } from 'react';\r\nimport Navbar from '@/components/dashboard/Navbar';\r\nimport SideBar from '@/components/dashboard/Sidebar';\r\nimport { useRouter } from 'next/navigation';\r\nimport { getProfile } from '@/api/profile';\r\nimport { removeToken } from '@/api/token';\r\n\r\n\r\nexport default function DashboardLayout({children} : {children : React.ReactNode}){\r\n\r\n  const router = useRouter();\r\n  const [profile, setProfile] = useState<any>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    (async () => {\r\n      try {\r\n        const p = await getProfile();\r\n        if (mounted) setProfile(p);\r\n      } \r\n      catch {\r\n        removeToken();\r\n        router.replace('/login'); \r\n      } \r\n      finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    })();\r\n\r\n    return () => { mounted = false; };\r\n    \r\n  }, [router]);\r\n\r\n  if (loading || !profile) {\r\n    return (\r\n      <main className=\"min-h-screen grid place-items-center p-6\">\r\n        <h1 className=\"text-2xl font-semibold\">Loading...</h1>\r\n      </main>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className='min-h-screen flex flex-col '>\r\n      <Navbar\r\n        username = {profile.username}\r\n        role = {profile.role}  \r\n        onLogout={() => {\r\n          removeToken();\r\n          router.push('/login');\r\n        }}\r\n      />\r\n      <div className='flex flex-1'>\r\n        <SideBar\r\n           role = {profile.role} \r\n          />\r\n        <main className='flex-1 p-6 min-w-0'>\r\n          {children}\r\n        </main>  \r\n      </div>\r\n          \r\n      \r\n    \r\n    </div>\r\n\r\n\r\n  )\r\n\r\n}"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;AACA;AACA;AANA;;;;;;;;AASe,SAAS,gBAAgB,EAAC,QAAQ,EAAgC;IAE/E,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAO;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,IAAI,UAAU;QACd,CAAC;YACC,IAAI;gBACF,MAAM,IAAI,MAAM,CAAA,GAAA,qHAAA,CAAA,aAAU,AAAD;gBACzB,IAAI,SAAS,WAAW;YAC1B,EACA,OAAM;gBACJ,CAAA,GAAA,mHAAA,CAAA,cAAW,AAAD;gBACV,OAAO,OAAO,CAAC;YACjB,SACQ;gBACN,IAAI,SAAS,WAAW;YAC1B;QACF,CAAC;QAED,OAAO;YAAQ,UAAU;QAAO;IAElC,GAAG;QAAC;KAAO;IAEX,IAAI,WAAW,CAAC,SAAS;QACvB,qBACE,8OAAC;YAAK,WAAU;sBACd,cAAA,8OAAC;gBAAG,WAAU;0BAAyB;;;;;;;;;;;IAG7C;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,yIAAA,CAAA,UAAM;gBACL,UAAY,QAAQ,QAAQ;gBAC5B,MAAQ,QAAQ,IAAI;gBACpB,UAAU;oBACR,CAAA,GAAA,mHAAA,CAAA,cAAW,AAAD;oBACV,OAAO,IAAI,CAAC;gBACd;;;;;;0BAEF,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,0IAAA,CAAA,UAAO;wBACL,MAAQ,QAAQ,IAAI;;;;;;kCAEvB,8OAAC;wBAAK,WAAU;kCACb;;;;;;;;;;;;;;;;;;AAWX","debugId":null}}]
}