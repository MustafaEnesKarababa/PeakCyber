{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 117, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nskar/OneDrive/Masa%C3%BCst%C3%BC/PeakCyber/VulnerabilityTestWebSite/www.vulnerabilityscan.com/src/api/axios.ts"],"sourcesContent":["import axios from 'axios';\r\n\r\nexport const api = axios.create({\r\n  baseURL: process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:7095/api',\r\n  // withCredentials: false // cookie kullanmıyoruz\r\n});\r\n\r\n// Dev ortamında istek/yanıtları logla (isteğe bağlı)\r\nif (process.env.NODE_ENV === 'development') {\r\n  api.interceptors.request.use((cfg) => {\r\n    console.log('[HTTP] ->', cfg.method?.toUpperCase(), cfg.baseURL + cfg.url, cfg.data);\r\n    return cfg;\r\n  });\r\n  api.interceptors.response.use(\r\n    (res) => {\r\n      console.log('[HTTP] <-', res.status, res.statusText, res.data);\r\n      return res;\r\n    },\r\n    (err) => {\r\n      console.log('[HTTP] ERR', err);\r\n      return Promise.reject(err);\r\n    }\r\n  );\r\n}\r\n\r\n// Hata mesajını .NET ProblemDetails dahil düzgün çıkar\r\nexport function extractAxiosError(err: unknown): string {\r\n  if (axios.isAxiosError(err)) {\r\n    if (!err.response) return err.message || 'Network error (CORS/SSL olabilir)';\r\n    const { status, statusText, data } = err.response;\r\n    if (typeof data === 'string') return `${status} ${statusText} - ${data}`;\r\n    if (data?.detail || data?.title) return `${status} ${data.title || statusText}${data.detail ? `: ${data.detail}` : ''}`;\r\n    if (data?.errors) {\r\n      try {\r\n        const lines = Object.values<any>(data.errors).flat();\r\n        return `${status} ${statusText} - ${lines.join(' | ')}`;\r\n      } catch { /* no-op */ }\r\n    }\r\n    return `${status} ${statusText}`;\r\n  }\r\n  // unknown error\r\n  return (err as any)?.message || 'Unknown error';\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,MAAM,qIAAA,CAAA,UAAK,CAAC,MAAM,CAAC;IAC9B,SAAS,iEAAwC;AAEnD;AAEA,qDAAqD;AACrD,wCAA4C;IAC1C,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAC5B,QAAQ,GAAG,CAAC,aAAa,IAAI,MAAM,EAAE,eAAe,IAAI,OAAO,GAAG,IAAI,GAAG,EAAE,IAAI,IAAI;QACnF,OAAO;IACT;IACA,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CAC3B,CAAC;QACC,QAAQ,GAAG,CAAC,aAAa,IAAI,MAAM,EAAE,IAAI,UAAU,EAAE,IAAI,IAAI;QAC7D,OAAO;IACT,GACA,CAAC;QACC,QAAQ,GAAG,CAAC,cAAc;QAC1B,OAAO,QAAQ,MAAM,CAAC;IACxB;AAEJ;AAGO,SAAS,kBAAkB,GAAY;IAC5C,IAAI,qIAAA,CAAA,UAAK,CAAC,YAAY,CAAC,MAAM;QAC3B,IAAI,CAAC,IAAI,QAAQ,EAAE,OAAO,IAAI,OAAO,IAAI;QACzC,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,IAAI,EAAE,GAAG,IAAI,QAAQ;QACjD,IAAI,OAAO,SAAS,UAAU,OAAO,GAAG,OAAO,CAAC,EAAE,WAAW,GAAG,EAAE,MAAM;QACxE,IAAI,MAAM,UAAU,MAAM,OAAO,OAAO,GAAG,OAAO,CAAC,EAAE,KAAK,KAAK,IAAI,aAAa,KAAK,MAAM,GAAG,CAAC,EAAE,EAAE,KAAK,MAAM,EAAE,GAAG,IAAI;QACvH,IAAI,MAAM,QAAQ;YAChB,IAAI;gBACF,MAAM,QAAQ,OAAO,MAAM,CAAM,KAAK,MAAM,EAAE,IAAI;gBAClD,OAAO,GAAG,OAAO,CAAC,EAAE,WAAW,GAAG,EAAE,MAAM,IAAI,CAAC,QAAQ;YACzD,EAAE,OAAM,CAAc;QACxB;QACA,OAAO,GAAG,OAAO,CAAC,EAAE,YAAY;IAClC;IACA,gBAAgB;IAChB,OAAO,AAAC,KAAa,WAAW;AAClC","debugId":null}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nskar/OneDrive/Masa%C3%BCst%C3%BC/PeakCyber/VulnerabilityTestWebSite/www.vulnerabilityscan.com/src/api/auth.ts"],"sourcesContent":["import { api, extractAxiosError } from './axios';\r\n\r\nconst API_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://localhost:7095/api';\r\n\r\n\r\n//Login \r\n\r\n// export async function login(email : string, password : string){\r\n\r\n//   const response = await fetch(`${API_BASE}/User/login`, {\r\n//     method: 'POST',\r\n//     headers: {\r\n//       'Content-Type': 'application/json',\r\n//     },\r\n//     body: JSON.stringify({ email, password }),\r\n//   });\r\n\r\n//   if (!response.ok) {\r\n//     throw new Error(await response.text() || 'Login failed');\r\n//   }\r\n\r\n\r\n//   return response.json();\r\n// }\r\n\r\nexport async function login(email: string, password: string) {\r\n  try {\r\n    const { data } = await api.post('/User/login', { email, password });\r\n    return data; // { token }\r\n  } catch (e) {\r\n    throw new Error(extractAxiosError(e));\r\n  }\r\n}\r\n\r\n//Register\r\n\r\nexport async function register(email: string, password: string , username: string, ) {\r\n  const response = await fetch(`${API_BASE}/User/register`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    \r\n    body: JSON.stringify({ email, password, username }),\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error(await response.text() || 'Registration failed');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,WAAW,iEAAwC;AAuBlD,eAAe,MAAM,KAAa,EAAE,QAAgB;IACzD,IAAI;QACF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,mHAAA,CAAA,MAAG,CAAC,IAAI,CAAC,eAAe;YAAE;YAAO;QAAS;QACjE,OAAO,MAAM,YAAY;IAC3B,EAAE,OAAO,GAAG;QACV,MAAM,IAAI,MAAM,CAAA,GAAA,mHAAA,CAAA,oBAAiB,AAAD,EAAE;IACpC;AACF;AAIO,eAAe,SAAS,KAAa,EAAE,QAAgB,EAAG,QAAgB;IAC/E,MAAM,WAAW,MAAM,MAAM,GAAG,SAAS,cAAc,CAAC,EAAE;QACxD,QAAQ;QACR,SAAS;YACP,gBAAgB;QAClB;QAEA,MAAM,KAAK,SAAS,CAAC;YAAE;YAAO;YAAU;QAAS;IACnD;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MAAM,MAAM,SAAS,IAAI,MAAM;IAC3C;IAEA,OAAO,SAAS,IAAI;AACtB","debugId":null}},
    {"offset": {"line": 200, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nskar/OneDrive/Masa%C3%BCst%C3%BC/PeakCyber/VulnerabilityTestWebSite/www.vulnerabilityscan.com/src/api/token.ts"],"sourcesContent":["const KEY = 'auth_token';\r\n\r\nexport const saveToken = (token: string) => {\r\n  localStorage.setItem(KEY, token);\r\n}\r\n\r\nexport const getToken  = () => {\r\n  return localStorage.getItem(KEY);\r\n}\r\n\r\nexport const removeToken = () => {\r\n  localStorage.removeItem(KEY);\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA,MAAM,MAAM;AAEL,MAAM,YAAY,CAAC;IACxB,aAAa,OAAO,CAAC,KAAK;AAC5B;AAEO,MAAM,WAAY;IACvB,OAAO,aAAa,OAAO,CAAC;AAC9B;AAEO,MAAM,cAAc;IACzB,aAAa,UAAU,CAAC;AAC1B","debugId":null}},
    {"offset": {"line": 219, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/nskar/OneDrive/Masa%C3%BCst%C3%BC/PeakCyber/VulnerabilityTestWebSite/www.vulnerabilityscan.com/src/app/%28auth%29/login/page.tsx"],"sourcesContent":["'use client'\r\nimport { useState } from 'react';\r\nimport { login } from '@/api/auth';\r\nimport { useRouter } from 'next/navigation';\r\nimport { saveToken } from '@/api/token';\r\n\r\nexport default function LoginPage() {\r\n  \r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const onSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    setLoading(true);\r\n\r\n    try{\r\n      const data = await login(email.trim(), password.trim());\r\n      const token = data.token || data.accessToken;\r\n      if (!token) {\r\n        throw new Error('No token received');\r\n      }\r\n      saveToken(token);\r\n      window.location.href = '/dashboard';\r\n    }\r\n    catch (e:any) {\r\n      setError(e.message || 'Login failed');\r\n    }\r\n    finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <main className=\"min-h-screen grid place-items-center p-6\">\r\n      <form onSubmit={onSubmit} className=\"w-full max-w-sm space-y-3\">\r\n          <h1 className='text-2xl font-semibold'>Sign In</h1>\r\n\r\n          <input className='w-full border rounded p-2' type =\"email\"\r\n            placeholder=\"Email\" value={email} onChange={(e) => setEmail(e.target.value)} required>\r\n          </input>\r\n\r\n          <input className='w-full border rounded p-2' type =\"password\"\r\n            placeholder=\"Password\" value={password} onChange={(e) => setPassword(e.target.value)} required>\r\n          </input>\r\n\r\n          {error && <p className=\"text-red-600 text-sm whitespace-pre-wrap\">{error}</p>}\r\n\r\n          <button className='w-full rounded p-2 border' disabled={loading}>\r\n            {loading ? 'Logging in...' : 'Login'}\r\n          </button>\r\n          <p className='text-sm'>\r\n            Don't have an account? <a className='underline' href=\"/register\">Register</a>\r\n          </p>\r\n\r\n      </form>\r\n\r\n    </main>\r\n  );\r\n\r\n\r\n}"],"names":[],"mappings":";;;;AACA;AACA;AAEA;AAJA;;;;;AAMe,SAAS;IAEtB,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACzC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,MAAM,WAAW,OAAO;QACtB,EAAE,cAAc;QAChB,SAAS;QACT,WAAW;QAEX,IAAG;YACD,MAAM,OAAO,MAAM,CAAA,GAAA,kHAAA,CAAA,QAAK,AAAD,EAAE,MAAM,IAAI,IAAI,SAAS,IAAI;YACpD,MAAM,QAAQ,KAAK,KAAK,IAAI,KAAK,WAAW;YAC5C,IAAI,CAAC,OAAO;gBACV,MAAM,IAAI,MAAM;YAClB;YACA,CAAA,GAAA,mHAAA,CAAA,YAAS,AAAD,EAAE;YACV,OAAO,QAAQ,CAAC,IAAI,GAAG;QACzB,EACA,OAAO,GAAO;YACZ,SAAS,EAAE,OAAO,IAAI;QACxB,SACQ;YACN,WAAW;QACb;IACF;IAEA,qBACE,8OAAC;QAAK,WAAU;kBACd,cAAA,8OAAC;YAAK,UAAU;YAAU,WAAU;;8BAChC,8OAAC;oBAAG,WAAU;8BAAyB;;;;;;8BAEvC,8OAAC;oBAAM,WAAU;oBAA4B,MAAM;oBACjD,aAAY;oBAAQ,OAAO;oBAAO,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;oBAAG,QAAQ;;;;;;8BAGvF,8OAAC;oBAAM,WAAU;oBAA4B,MAAM;oBACjD,aAAY;oBAAW,OAAO;oBAAU,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;oBAAG,QAAQ;;;;;;gBAG/F,uBAAS,8OAAC;oBAAE,WAAU;8BAA4C;;;;;;8BAEnE,8OAAC;oBAAO,WAAU;oBAA4B,UAAU;8BACrD,UAAU,kBAAkB;;;;;;8BAE/B,8OAAC;oBAAE,WAAU;;wBAAU;sCACE,8OAAC;4BAAE,WAAU;4BAAY,MAAK;sCAAY;;;;;;;;;;;;;;;;;;;;;;;AAS7E","debugId":null}}]
}